# âœ… æ¨é€æˆåŠŸï¼ä¸‹ä¸€æ­¥é©Ÿ

## ğŸ‰ æ¨é€ç‹€æ…‹

âœ… **æˆåŠŸæ¨é€åˆ° GitHubï¼**

- Commit: `85cd6dd`
- åˆ†æ”¯: `main`
- Workflow æ–‡ä»¶å·²ä¸Šå‚³ï¼š
  - `.github/workflows/database-init-simple.yml`
  - `.github/workflows/database-init.yml`
  - `.github/workflows/database-setup-on-demand.yml`

---

## ğŸ“‹ æ¥ä¸‹ä¾†éœ€è¦åšçš„äº‹ï¼ˆ3 æ­¥é©Ÿï¼‰

### æ­¥é©Ÿ 1: æ·»åŠ  DATABASE_URL Secret â­ æœ€é‡è¦

1. **å‰å¾€ GitHub Secrets è¨­ç½®é é¢**ï¼š
   ```
   https://github.com/aa89976566/p.et-taiwan/settings/secrets/actions
   ```

2. **é»æ“Š "New repository secret"**

3. **è¼¸å…¥ä»¥ä¸‹è³‡è¨Š**ï¼š
   - **Name**: `DATABASE_URL`
   - **Value**: `postgresql://postgres:YOUR_PASSWORD@turntable.proxy.rlwy.net:36497/railway?sslmode=require`
     - âš ï¸ **é‡è¦**ï¼šæ›¿æ› `YOUR_PASSWORD` ç‚ºå¯¦éš›çš„ Railway PostgreSQL å¯†ç¢¼
     - æˆ–è€…å¾ Railway Dashboard è¤‡è£½å®Œæ•´çš„é€£æ¥å­—ä¸²

4. **é»æ“Š "Add secret"**

---

### æ­¥é©Ÿ 2: æ‰‹å‹•è§¸ç™¼ Workflow

1. **å‰å¾€ Actions é é¢**ï¼š
   ```
   https://github.com/aa89976566/p.et-taiwan/actions
   ```

2. **åœ¨å·¦å´é¸æ“‡ "Database Init (Simple)" workflow**

3. **é»æ“Šå³ä¸Šè§’çš„ "Run workflow" æŒ‰éˆ•**

4. **é¸æ“‡åˆ†æ”¯**: `main`

5. **é»æ“Šç¶ è‰²çš„ "Run workflow" æŒ‰éˆ•**

---

### æ­¥é©Ÿ 3: æŸ¥çœ‹åŸ·è¡Œçµæœ

1. **é»æ“Šæœ€æ–°çš„ workflow run**ï¼ˆæ‡‰è©²æœƒçœ‹åˆ°é»ƒè‰²çš„ "In progress" æˆ–ç¶ è‰²çš„ "Success"ï¼‰

2. **é»æ“Š "init-db" job**

3. **å±•é–‹å„å€‹æ­¥é©ŸæŸ¥çœ‹è©³ç´°æ—¥èªŒ**

**æˆåŠŸæ™‚æ‡‰è©²çœ‹åˆ°**ï¼š
```
ğŸš€ é–‹å§‹è¨­ç½® Railway PostgreSQL è³‡æ–™åº«...
âœ… å·²é€£æ¥åˆ° PostgreSQL è³‡æ–™åº«
âœ… SELECT 1 æˆåŠŸï¼
âœ… PostgreSQL é€£ç·šæ¸¬è©¦æˆåŠŸ
æº–å‚™å»ºç«‹ 11 å€‹è³‡æ–™è¡¨...
   âœ… users å»ºç«‹æˆåŠŸ
   âœ… products å»ºç«‹æˆåŠŸ
   âœ… product_variants å»ºç«‹æˆåŠŸ
   âœ… orders å»ºç«‹æˆåŠŸ
   âœ… order_items å»ºç«‹æˆåŠŸ
   âœ… quiz_results å»ºç«‹æˆåŠŸ
   âœ… subscriptions å»ºç«‹æˆåŠŸ
   âœ… cart_items å»ºç«‹æˆåŠŸ
   âœ… settings å»ºç«‹æˆåŠŸ
   âœ… coupons å»ºç«‹æˆåŠŸ
   âœ… coupon_usage å»ºç«‹æˆåŠŸ
âœ… PostgreSQL è³‡æ–™åº«è¡¨çµæ§‹åˆå§‹åŒ–å®Œæˆï¼ˆå…± 11 å€‹è³‡æ–™è¡¨ï¼‰
âœ… è³‡æ–™åº«è¨­ç½®å®Œæˆï¼
```

---

## ğŸ” å¦‚ä½•ç²å–æ­£ç¢ºçš„ DATABASE_URL

### æ–¹æ³• 1: å¾ Railway Dashboardï¼ˆæ¨è–¦ï¼‰

1. ç™»å…¥ Railway Dashboard
2. é¸æ“‡ PostgreSQL æœå‹™
3. é»æ“Š **"Connect"** æŒ‰éˆ•
4. æ‰¾åˆ° **"Public Networking"** å€å¡Š
5. è¤‡è£½å®Œæ•´çš„ **Connection String**

### æ–¹æ³• 2: æ‰‹å‹•æ§‹å»º

æ ¹æ“šæ‚¨æä¾›çš„ä¸»æ©Ÿ `turntable.proxy.rlwy.net:36497`ï¼š

```
postgresql://postgres:YOUR_PASSWORD@turntable.proxy.rlwy.net:36497/railway?sslmode=require
```

**é‡è¦æç¤º**ï¼š
- å¿…é ˆåŒ…å« `?sslmode=require`ï¼ˆRailway éœ€è¦ SSLï¼‰
- ç¢ºèªè³‡æ–™åº«åç¨±ï¼ˆé€šå¸¸æ˜¯ `railway`ï¼‰
- ç¢ºèªç”¨æˆ¶åï¼ˆé€šå¸¸æ˜¯ `postgres`ï¼‰

---

## ğŸ› å¦‚æœåŸ·è¡Œå¤±æ•—

### å•é¡Œ 1: "DATABASE_URL not found"

**è§£æ±ºæ–¹æ³•**ï¼š
- ç¢ºèª Secret åç¨±å®Œå…¨ä¸€è‡´ï¼š`DATABASE_URL`ï¼ˆå¤§å°å¯«æ•æ„Ÿï¼‰
- ç¢ºèªå·²åœ¨æ­£ç¢ºçš„å€‰åº«ä¸­æ·»åŠ ï¼ˆä¸æ˜¯çµ„ç¹”å±¤ç´šï¼‰

### å•é¡Œ 2: "Connection refused" æˆ– "Connection timeout"

**å¯èƒ½åŸå› **ï¼š
- DATABASE_URL æ ¼å¼éŒ¯èª¤
- ç¼ºå°‘ SSL åƒæ•¸
- å¯†ç¢¼éŒ¯èª¤

**è§£æ±ºæ–¹æ³•**ï¼š
- ç¢ºèªåŒ…å« `?sslmode=require`
- å¾ Railway Dashboard é‡æ–°è¤‡è£½å®Œæ•´çš„é€£æ¥å­—ä¸²
- ç¢ºèª Railway PostgreSQL æœå‹™æ­£åœ¨é‹è¡Œ

### å•é¡Œ 3: "npm run init-db not found"

**è§£æ±ºæ–¹æ³•**ï¼š
- ç°¡åŒ–ç‰ˆ workflow å·²ç¶“æœ‰ fallbackï¼Œæœƒè‡ªå‹•ä½¿ç”¨ `node scripts/setup-railway-db.js`
- ç¢ºä¿ `scripts/setup-railway-db.js` æ–‡ä»¶å·²æ¨é€åˆ° GitHubï¼ˆâœ… å·²å®Œæˆï¼‰

---

## âœ… å®Œæˆå¾Œé©—è­‰

åŸ·è¡ŒæˆåŠŸå¾Œï¼Œåœ¨ Railway PostgreSQL Query ä»‹é¢é©—è­‰è³‡æ–™è¡¨ï¼š

```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_type = 'BASE TABLE'
ORDER BY table_name;
```

**æ‡‰è©²æœƒçœ‹åˆ° 11 å€‹è³‡æ–™è¡¨**ã€‚

---

## ğŸ¯ å¿«é€Ÿæª¢æŸ¥æ¸…å–®

- [x] âœ… Workflow æ–‡ä»¶å·²æ¨é€åˆ° GitHub
- [ ] â³ åœ¨ GitHub Secrets ä¸­æ·»åŠ  `DATABASE_URL`
- [ ] â³ æ‰‹å‹•è§¸ç™¼ workflow æ¸¬è©¦
- [ ] â³ æŸ¥çœ‹åŸ·è¡Œæ—¥èªŒç¢ºèªæˆåŠŸ
- [ ] â³ åœ¨ Railway PostgreSQL é©—è­‰è³‡æ–™è¡¨å·²å»ºç«‹

---

**ç¾åœ¨è«‹å®Œæˆæ­¥é©Ÿ 1ï¼ˆæ·»åŠ  DATABASE_URL Secretï¼‰ï¼Œç„¶å¾Œæ‰‹å‹•è§¸ç™¼ workflowï¼** ğŸš€
