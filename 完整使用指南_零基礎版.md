# 🎓 匠寵網站完整使用指南 - 零基礎版

## 🎯 你現在的狀態

恭喜！✅ **後端已成功部署到 Railway！**

但是... ⚠️ **前端還在連接 `localhost:3000`（你的電腦）**

---

## 📚 第一部分：理解你的系統架構

### 🏗️ 你的網站分成兩部分：

```
┌─────────────────────────────────────────────┐
│              你的完整系統                    │
├─────────────────────────────────────────────┤
│                                             │
│  1️⃣ 前端 (Frontend)                        │
│  ├── HTML 文件 (index.html, admin.html...)  │
│  ├── JavaScript (js/api-client.js...)       │
│  ├── CSS 樣式                               │
│  └── 圖片資源                               │
│  📍 目前位置: 你的電腦或 GitHub             │
│                                             │
│  2️⃣ 後端 (Backend) ✅ 已部署！              │
│  ├── API 服務器 (server.js)                │
│  ├── 資料庫連接 (PostgreSQL)               │
│  ├── 用戶認證、訂單管理等                   │
│  └── 11 個資料表 (users, products...)      │
│  📍 目前位置: Railway (雲端)               │
│  🔗 URL: https://你的項目.railway.app      │
│                                             │
└─────────────────────────────────────────────┘
```

### 🔄 它們如何協作？

```
用戶瀏覽網站 → 前端 HTML/JS → 發送 API 請求 → 後端處理 → 資料庫存取 → 返回結果 → 前端顯示
```

---

## 📋 第二部分：目前的問題

### ❌ 當前配置（錯誤）

在 `js/api-client.js` 第 6 行：
```javascript
const API_BASE_URL = 'http://localhost:3000/api';
```

**問題**：
- `localhost:3000` 是指"你的電腦上的 3000 端口"
- 其他人訪問網站時，會嘗試連接他們自己電腦的 3000 端口
- 但你的後端在 Railway 雲端，不在他們電腦上！

### ✅ 應該改成什麼？

```javascript
const API_BASE_URL = 'https://你的Railway項目名稱.railway.app/api';
```

---

## 🚀 第三部分：獲取你的 Railway 後端 URL

### 步驟 1: 找到你的後端 URL

1. **進入 Railway Dashboard**
2. **選擇 p.et-taiwan 服務**
3. **點擊 Settings 標籤**
4. **找到 "Domains" 或 "Public Networking" 區域**
5. **點擊 "Generate Domain"**（如果還沒有域名）

你會得到類似這樣的 URL：
```
https://p-et-taiwan-production.railway.app
```

或

```
https://p-et-taiwan-production-xxxx.railway.app
```

### 步驟 2: 測試後端是否正常

**在瀏覽器中訪問**：
```
https://你的Railway域名.railway.app/health
```

**預期結果**：
```json
{
  "success": true,
  "message": "服務運行正常",
  "timestamp": "2026-01-10T15:30:00.000Z"
}
```

**如果看到這個 JSON，表示後端正常運行！** ✅

### 步驟 3: 測試資料表

**訪問**：
```
https://你的Railway域名.railway.app/api/check-tables
```

**預期結果**：
```json
{
  "success": true,
  "data": {
    "dbType": "postgresql",
    "totalTables": 11,
    "tables": ["users", "products", "orders", ...],
    "allTablesExist": true,
    "message": "✅ 所有資料表都已建立！"
  }
}
```

**如果看到這個，資料庫也正常！** ✅

---

## 🔧 第四部分：修改前端配置

### 方法 1: 修改 API URL（立即生效）

我現在幫你修改前端配置文件：

**請先告訴我你的 Railway 域名**，然後我會幫你更新 `js/api-client.js`

例如：
- 如果你的 Railway 域名是：`https://p-et-taiwan-production.railway.app`
- 我會幫你改成：
  ```javascript
  const API_BASE_URL = 'https://p-et-taiwan-production.railway.app/api';
  ```

### 方法 2: 使用環境自動檢測（推薦）

更智能的方式：讓系統自動判斷使用本地還是線上：

```javascript
// 自動檢測環境
const API_BASE_URL = window.location.hostname === 'localhost' 
    ? 'http://localhost:3000/api'  // 本地開發
    : 'https://你的Railway域名.railway.app/api';  // 線上環境
```

---

## 📊 第五部分：理解資料庫如何運作（不需要你操作）

### 資料庫已經自動創建了 11 個資料表：

| 資料表 | 用途 | 你需要做什麼？ |
|-------|------|-------------|
| `users` | 儲存會員資料 | ❌ 不需要 - 用戶註冊時自動創建 |
| `products` | 儲存商品資料 | ✅ 需要 - 在後台手動添加商品 |
| `orders` | 儲存訂單資料 | ❌ 不需要 - 用戶下單時自動創建 |
| `cart_items` | 儲存購物車 | ❌ 不需要 - 加入購物車時自動儲存 |
| `coupons` | 儲存優惠券 | ✅ 需要 - 在後台手動添加優惠券 |
| `subscriptions` | 儲存訂閱 | ❌ 不需要 - 用戶訂閱時自動創建 |
| `quiz_results` | 儲存測驗結果 | ❌ 不需要 - 用戶完成測驗時自動儲存 |
| 其他... | ... | ... |

### 你不需要寫 SQL 或操作資料庫！

**為什麼？** 因為後端 API 已經幫你處理好了：

```
用戶註冊 → 前端呼叫 /api/auth/register → 後端自動寫入 users 資料表 ✅
用戶登入 → 前端呼叫 /api/auth/login → 後端檢查 users 資料表 ✅
添加商品 → 前端呼叫 /api/products → 後端寫入 products 資料表 ✅
創建訂單 → 前端呼叫 /api/orders → 後端寫入 orders 資料表 ✅
```

**你只需要使用網站介面，資料會自動儲存！**

---

## 🎯 第六部分：接下來你需要做的事情

### 立即要做的（必須）：

#### 1️⃣ 獲取 Railway 後端 URL
- 進入 Railway Dashboard
- 找到你的公開域名
- 複製 URL（例如：`https://p-et-taiwan-production.railway.app`）

#### 2️⃣ 更新前端 API 配置
- 把 Railway URL 告訴我
- 我會幫你更新 `js/api-client.js`
- 提交並推送到 GitHub

#### 3️⃣ 部署前端
- 選擇部署方式（見下方）
- 讓用戶可以訪問你的網站

---

## 🌐 第七部分：前端部署選項

你有幾個選擇來部署前端：

### 選項 1: GitHub Pages（免費，簡單）

**優點**：
- ✅ 完全免費
- ✅ 自動從 GitHub 部署
- ✅ 提供 HTTPS

**步驟**：
1. GitHub 倉庫 → Settings → Pages
2. Source 選擇 main 分支
3. 自動生成 URL：`https://你的用戶名.github.io/p.et-taiwan`

### 選項 2: Cloudflare Pages（免費，推薦）

**優點**：
- ✅ 完全免費
- ✅ 超快速度（全球 CDN）
- ✅ 自動從 GitHub 部署
- ✅ 可以綁定自定義域名

**步驟**：
1. 註冊 Cloudflare 帳號
2. 連接 GitHub 倉庫
3. 自動部署

### 選項 3: Railway（也可以部署前端）

**優點**：
- ✅ 前後端在同一個地方
- ✅ 易於管理

**步驟**：
1. 在 Railway 新增一個服務
2. 設置為靜態網站
3. 指向根目錄

### 選項 4: Vercel（免費，簡單）

**優點**：
- ✅ 完全免費
- ✅ 自動部署
- ✅ 提供 HTTPS

---

## 📝 第八部分：使用流程示例

### 場景 1: 用戶註冊

```
用戶填寫註冊表單
  ↓
前端 JS 收集資料
  ↓
發送到 https://你的Railway.railway.app/api/auth/register
  ↓
後端驗證資料
  ↓
寫入 PostgreSQL 資料庫的 users 資料表
  ↓
返回成功訊息
  ↓
前端顯示"註冊成功"
```

### 場景 2: 管理員添加商品

```
管理員登入後台
  ↓
填寫商品資料（名稱、價格、圖片...）
  ↓
前端發送到 /api/products
  ↓
後端驗證管理員權限
  ↓
寫入 products 資料表
  ↓
商品立即出現在網站上
```

### 場景 3: 用戶下單

```
用戶選擇商品 → 加入購物車 → 結帳
  ↓
前端收集訂單資訊
  ↓
發送到 /api/orders
  ↓
後端創建訂單記錄（orders 資料表）
  ↓
創建訂單項目（order_items 資料表）
  ↓
更新商品庫存（products 資料表）
  ↓
返回訂單編號
  ↓
前端顯示"訂單成功"
```

---

## 🎓 第九部分：常見問題解答

### Q1: 我需要學習資料庫嗎？

**A:** 不需要！你的後端已經處理好所有資料庫操作。你只需要：
- 使用網站介面添加商品
- 用戶註冊、登入會自動儲存
- 訂單會自動記錄

### Q2: 資料會不會遺失？

**A:** 不會！資料存在 Railway 的 PostgreSQL 資料庫中：
- ✅ 有自動備份
- ✅ 24/7 運行
- ✅ 專業託管

### Q3: 如何查看資料？

**A:** 有幾種方式：
1. **透過後台介面**：訪問 `admin-*.html` 頁面
2. **透過 API**：訪問 `https://你的域名/api/check-tables`
3. **透過 Railway**：在 Railway Dashboard 的 PostgreSQL Query 介面

### Q4: 需要付費嗎？

**A:** Railway 有免費額度：
- ✅ 免費用戶：每月 $5 免費額度
- ✅ 夠小型網站使用
- ✅ 超過才需要付費

---

## 🎯 總結：你現在要做的

### ✅ 第 1 步（現在）：
告訴我你的 Railway 後端 URL，我會幫你更新前端配置

### ✅ 第 2 步（5 分鐘）：
選擇一個前端部署方式（推薦 GitHub Pages 或 Cloudflare Pages）

### ✅ 第 3 步（10 分鐘）：
部署前端，測試網站是否正常運作

### ✅ 第 4 步（日常使用）：
- 使用後台添加商品
- 用戶可以註冊、登入、下單
- 所有資料自動儲存到資料庫

---

## 📞 需要我幫忙什麼？

請告訴我：

1. **你的 Railway 後端 URL 是什麼？**
   - 我會幫你更新前端配置

2. **你想用哪種方式部署前端？**
   - GitHub Pages（最簡單）
   - Cloudflare Pages（最快）
   - Railway（統一管理）
   - Vercel（也很簡單）

3. **你有沒有自己的域名？**
   - 如果有，可以綁定自定義域名

---

**你不需要懂資料庫，系統已經幫你處理好了！** 🎉

只需要：
1. 獲取 Railway URL
2. 更新前端配置
3. 部署前端
4. 開始使用！

**準備好告訴我你的 Railway URL 了嗎？** 🚀
