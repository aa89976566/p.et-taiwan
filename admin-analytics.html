<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‡Ÿæ”¶å ±è¡¨ - åŒ å¯µå¾Œå°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .sidebar-item {
            transition: all 0.2s ease;
        }
        .sidebar-item:hover {
            background: rgba(230, 57, 70, 0.1);
            border-left: 4px solid #E63946;
        }
        .sidebar-item.active {
            background: rgba(230, 57, 70, 0.15);
            border-left: 4px solid #E63946;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- é ‚éƒ¨å°èˆªæ¬„ -->
    <nav class="bg-white border border-gray-200 fixed top-0 left-0 right-0 z-50">
        <div class="flex items-center justify-between px-6 py-4">
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-orange-400 rounded-xl flex items-center justify-center">
                        <i class="fas fa-paw text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">åŒ å¯µå¾Œå°</h1>
                        <p class="text-xs text-gray-500">ç‡Ÿæ”¶å ±è¡¨</p>
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button onclick="exportReport()" class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors">
                    <i class="fas fa-download mr-2"></i>åŒ¯å‡ºå ±è¡¨
                </button>
                <button class="relative text-gray-600 hover:text-gray-800">
                    <i class="fas fa-bell text-xl"></i>
                    <span class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">3</span>
                </button>
                <div class="flex items-center space-x-3 border-l pl-4">
                    <div class="hidden md:block text-right">
                        <p class="text-sm font-semibold text-gray-800" id="adminName">è¶…ç´šç®¡ç†å“¡</p>
                        <p class="text-xs text-gray-500" id="adminRole">Super Admin</p>
                    </div>
                    <button onclick="showUserMenu()" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold">A</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- å´é‚Šæ¬„ -->
    <aside id="sidebar" class="sidebar fixed left-0 top-16 bottom-0 w-64 bg-white border border-gray-200 overflow-y-auto z-40">
    <div class="p-4">
        <nav class="space-y-2">
            <a href="admin-dashboard.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                <i class="fas fa-chart-line text-lg w-6"></i>
                <span>å„€è¡¨æ¿</span>
            </a>
            <div class="sidebar-section">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">ç”¨æˆ¶ç®¡ç†</p>
                <a href="admin-users.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-users text-lg w-6"></i>
                    <span>ç”¨æˆ¶åˆ—è¡¨</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">å•†å“ç®¡ç†</p>
                <a href="admin-products.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-box text-lg w-6"></i>
                    <span>ç”¢å“åˆ—è¡¨</span>
                </a>
                <a href="admin-orders.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-shopping-cart text-lg w-6"></i>
                    <span>è¨‚å–®ç®¡ç†</span>
                    <span class="ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full">15</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">ç‰©æµç®¡ç†</p>
                <a href="admin-shipping.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-shipping-fast text-lg w-6"></i>
                    <span>ç‰©æµè¨­å®š</span>
                </a>
                <a href="checkout.html" target="_blank" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-truck text-lg w-6"></i>
                    <span>æ¸¬è©¦çµå¸³æµç¨‹</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">æ¸¬é©—ç³»çµ±</p>
                <a href="admin-quizzes.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-clipboard-list text-lg w-6"></i>
                    <span>æ¸¬é©—åˆ—è¡¨</span>
                </a>
                <a href="admin-quiz-stats.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-chart-pie text-lg w-6"></i>
                    <span>æ¸¬é©—çµ±è¨ˆ</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">è¨‚é–±æœå‹™</p>
                <a href="admin-subscription-management.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-sync-alt text-lg w-6"></i>
                    <span>è¨‚é–±ç®¡ç†</span>
                </a>
                <a href="admin-subscription-options.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-list-alt text-lg w-6"></i>
                    <span>è¨‚é–±é¸é …</span>
                </a>
                <a href="admin-jar-program.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-recycle text-lg w-6"></i>
                    <span>æ›ç½è¨ˆç•«</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">æ•¸æ“šåˆ†æ</p>
                <a href="admin-analytics.html" class="sidebar-item active flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-chart-bar text-lg w-6"></i>
                    <span>ç‡Ÿæ”¶å ±è¡¨</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">ç³»çµ±è¨­å®š</p>
                <a href="admin-homepage.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-edit text-lg w-6"></i>
                    <span>é¦–é å…§å®¹ç®¡ç†</span>
                </a>
                <a href="admin-website-settings.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-palette text-lg w-6"></i>
                    <span>ç¶²ç«™ä½ˆå±€</span>
                </a>
                <a href="admin-payment.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-credit-card text-lg w-6"></i>
                    <span>é‡‘æµè¨­å®š</span>
                </a>
                <a href="admin-settings.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-cog text-lg w-6"></i>
                    <span>ç³»çµ±è¨­å®š</span>
                </a>
                <a href="admin-login.html" onclick="logout()" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-red-600">
                    <i class="fas fa-sign-out-alt text-lg w-6"></i>
                    <span>ç™»å‡º</span>
                </a>
            </div>
        </nav>
    </div>
</aside>

    <!-- ä¸»è¦å…§å®¹å€ -->
    <main class="ml-64 mt-16 p-6">
        <!-- é é¢æ¨™é¡Œ -->
        <div class="mb-6">
            <h2 class="text-3xl font-bold text-gray-800">ç‡Ÿæ”¶å ±è¡¨</h2>
            <p class="text-gray-600 mt-1">å®Œæ•´çš„ç‡Ÿæ”¶æ•¸æ“šåˆ†æèˆ‡è¦–è¦ºåŒ–åœ–è¡¨</p>
        </div>

        <!-- æ™‚é–“ç¯„åœé¸æ“‡ -->
        <div class="bg-white rounded-2xl shadow-md p-6 mb-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="setDateRange('today')" class="px-4 py-2 bg-gray-200 hover:bg-red-500 hover:text-white rounded-lg transition">ä»Šæ—¥</button>
                    <button onclick="setDateRange('week')" class="px-4 py-2 bg-gray-200 hover:bg-red-500 hover:text-white rounded-lg transition">æœ¬é€±</button>
                    <button onclick="setDateRange('month')" class="px-4 py-2 bg-red-500 text-white rounded-lg">æœ¬æœˆ</button>
                    <button onclick="setDateRange('year')" class="px-4 py-2 bg-gray-200 hover:bg-red-500 hover:text-white rounded-lg transition">æœ¬å¹´</button>
                    <button onclick="setDateRange('custom')" class="px-4 py-2 bg-gray-200 hover:bg-red-500 hover:text-white rounded-lg transition">
                        <i class="fas fa-calendar-alt mr-1"></i>è‡ªè¨‚ç¯„åœ
                    </button>
                </div>
                <span class="text-gray-600">2024-12-01 ~ 2024-12-21</span>
            </div>
        </div>

        <!-- KPI å¡ç‰‡ -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
            <div class="bg-white rounded-2xl shadow-md p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-green-400 to-green-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-dollar-sign text-white text-xl"></i>
                    </div>
                    <span class="text-green-600 text-sm font-semibold">
                        <i class="fas fa-arrow-up"></i> 18.7%
                    </span>
                </div>
                <p class="text-gray-600 text-sm mb-1">æœ¬æœˆç‡Ÿæ”¶</p>
                <p class="text-3xl font-bold text-gray-800">NT$ 685,340</p>
                <p class="text-xs text-gray-500 mt-2">è¼ƒä¸Šæœˆ NT$ 577,650</p>
            </div>

            <div class="bg-white rounded-2xl shadow-md p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-shopping-bag text-white text-xl"></i>
                    </div>
                    <span class="text-blue-600 text-sm font-semibold">
                        <i class="fas fa-arrow-up"></i> 12.3%
                    </span>
                </div>
                <p class="text-gray-600 text-sm mb-1">è¨‚å–®æ•¸é‡</p>
                <p class="text-3xl font-bold text-gray-800">342</p>
                <p class="text-xs text-gray-500 mt-2">è¼ƒä¸Šæœˆ 304 ç­†</p>
            </div>

            <div class="bg-white rounded-2xl shadow-md p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-chart-line text-white text-xl"></i>
                    </div>
                    <span class="text-purple-600 text-sm font-semibold">
                        <i class="fas fa-arrow-up"></i> 5.8%
                    </span>
                </div>
                <p class="text-gray-600 text-sm mb-1">å®¢å–®åƒ¹</p>
                <p class="text-3xl font-bold text-gray-800">NT$ 2,004</p>
                <p class="text-xs text-gray-500 mt-2">è¼ƒä¸Šæœˆ NT$ 1,894</p>
            </div>

            <div class="bg-white rounded-2xl shadow-md p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-orange-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-redo text-white text-xl"></i>
                    </div>
                    <span class="text-orange-600 text-sm font-semibold">
                        <i class="fas fa-arrow-up"></i> 28.5%
                    </span>
                </div>
                <p class="text-gray-600 text-sm mb-1">å›è³¼ç‡</p>
                <p class="text-3xl font-bold text-gray-800">34.2%</p>
                <p class="text-xs text-gray-500 mt-2">è¼ƒä¸Šæœˆ 26.6%</p>
            </div>
        </div>

        <!-- åœ–è¡¨å€åŸŸ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- ç‡Ÿæ”¶è¶¨å‹¢åœ– -->
            <div class="bg-white rounded-2xl shadow-md p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">æœˆåº¦ç‡Ÿæ”¶è¶¨å‹¢</h3>
                <canvas id="revenueChart" style="height: 300px;"></canvas>
            </div>

            <!-- ç”¢å“é¡åˆ¥éŠ·å”® -->
            <div class="bg-white rounded-2xl shadow-md p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ç”¢å“é¡åˆ¥éŠ·å”®ä½”æ¯”</h3>
                <canvas id="categoryChart" style="height: 300px;"></canvas>
            </div>
        </div>

        <!-- è©³ç´°æ•¸æ“šè¡¨æ ¼ -->
        <div class="bg-white rounded-2xl shadow-md overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-xl font-bold text-gray-800">æ¯æ—¥ç‡Ÿæ”¶æ˜ç´°</h3>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">æ—¥æœŸ</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">è¨‚å–®æ•¸</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">ç‡Ÿæ”¶</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">å®¢å–®åƒ¹</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">æˆé•·ç‡</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200" id="revenueTableBody">
                        <!-- å‹•æ…‹ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <script>
        // ç‡Ÿæ”¶è¶¨å‹¢åœ–
        const revenueCtx = document.getElementById('revenueChart').getContext('2d');
        const revenueChart = new Chart(revenueCtx, {
            type: 'line',
            data: {
                labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'],
                datasets: [{
                    label: 'ç‡Ÿæ”¶ (NT$)',
                    data: [420000, 450000, 480000, 510000, 520000, 550000, 580000, 600000, 620000, 650000, 670000, 685340],
                    borderColor: 'rgb(239, 68, 68)',
                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return 'NT$ ' + context.parsed.y.toLocaleString();
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return 'NT$ ' + (value / 1000) + 'K';
                            }
                        }
                    }
                },
                onClick: function(evt, items) {
                    if (items.length > 0) {
                        const index = items[0].index;
                        const month = this.data.labels[index];
                        const value = this.data.datasets[0].data[index];
                        alert(`ğŸ“Š ${month}è©³ç´°ç‡Ÿæ”¶\n\nç¸½ç‡Ÿæ”¶: NT$ ${value.toLocaleString()}\n\nâ€¢ ç”¢å“éŠ·å”®: NT$ ${Math.round(value * 0.87).toLocaleString()}\nâ€¢ è¨‚é–±æœå‹™: NT$ ${Math.round(value * 0.08).toLocaleString()}\nâ€¢ å…¶ä»–æ”¶å…¥: NT$ ${Math.round(value * 0.05).toLocaleString()}`);
                    }
                }
            }
        });

        // ç”¢å“é¡åˆ¥éŠ·å”®åœ–
        const categoryCtx = document.getElementById('categoryChart').getContext('2d');
        const categoryChart = new Chart(categoryCtx, {
            type: 'doughnut',
            data: {
                labels: ['å°ç£å¤œå¸‚é›¶é£Ÿ', 'ç›Šæ™ºç©å…·', 'ç‡Ÿé¤Šç½è¨‚é–±', 'å…¶ä»–'],
                datasets: [{
                    data: [45, 28, 22, 5],
                    backgroundColor: [
                        'rgb(239, 68, 68)',
                        'rgb(59, 130, 246)',
                        'rgb(16, 185, 129)',
                        'rgb(156, 163, 175)'
                    ],
                    borderWidth: 2,
                    borderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 15,
                            font: {
                                size: 12
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.parsed + '%';
                            }
                        }
                    }
                },
                onClick: function(evt, items) {
                    if (items.length > 0) {
                        const index = items[0].index;
                        const category = this.data.labels[index];
                        const percentage = this.data.datasets[0].data[index];
                        const sales = Math.round(342 * percentage / 100);
                        const revenue = Math.round(685340 * percentage / 100);
                        alert(`${category}\n\néŠ·å”®ä½”æ¯”: ${percentage}%\næœ¬æœˆéŠ·é‡: ${sales} ä»¶\næœ¬æœˆç‡Ÿæ”¶: NT$ ${revenue.toLocaleString()}`);
                    }
                }
            }
        });

        // ç”Ÿæˆæ¯æ—¥ç‡Ÿæ”¶è¡¨æ ¼
        function generateRevenueTable() {
            const tbody = document.getElementById('revenueTableBody');
            const data = [
                { date: '2024-12-21', orders: 28, revenue: 48520, avgOrder: 1733, growth: 15.2 },
                { date: '2024-12-20', orders: 32, revenue: 55680, avgOrder: 1740, growth: 22.3 },
                { date: '2024-12-19', orders: 25, revenue: 42350, avgOrder: 1694, growth: -8.5 },
                { date: '2024-12-18', orders: 30, revenue: 51900, avgOrder: 1730, growth: 18.7 },
                { date: '2024-12-17', orders: 27, revenue: 47250, avgOrder: 1750, growth: 12.4 },
                { date: '2024-12-16', orders: 29, revenue: 50290, avgOrder: 1734, growth: 15.8 },
                { date: '2024-12-15', orders: 24, revenue: 41760, avgOrder: 1740, growth: -5.2 }
            ];

            tbody.innerHTML = data.map(d => `
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 text-sm text-gray-800">${d.date}</td>
                    <td class="px-6 py-4 text-sm font-semibold text-gray-800">${d.orders}</td>
                    <td class="px-6 py-4 text-sm font-semibold text-gray-800">NT$ ${d.revenue.toLocaleString()}</td>
                    <td class="px-6 py-4 text-sm text-gray-600">NT$ ${d.avgOrder.toLocaleString()}</td>
                    <td class="px-6 py-4 text-sm">
                        <span class="${d.growth >= 0 ? 'text-green-600' : 'text-red-600'} font-semibold">
                            <i class="fas fa-arrow-${d.growth >= 0 ? 'up' : 'down'}"></i> ${Math.abs(d.growth)}%
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        function setDateRange(range) {
            alert(`ğŸ“… å·²åˆ‡æ›åˆ°${range === 'today' ? 'ä»Šæ—¥' : range === 'week' ? 'æœ¬é€±' : range === 'month' ? 'æœ¬æœˆ' : range === 'year' ? 'æœ¬å¹´' : 'è‡ªè¨‚ç¯„åœ'}è¦–åœ–\n\nåœ–è¡¨è³‡æ–™å·²æ›´æ–°`);
            // å¯¦éš›æ‡‰ç”¨ä¸­æœƒé‡æ–°è¼‰å…¥å°æ‡‰æ™‚é–“ç¯„åœçš„è³‡æ–™
        }

        function exportReport() {
            alert('ğŸ“Š åŒ¯å‡ºç‡Ÿæ”¶å ±è¡¨\n\nå ±è¡¨å°‡åŒ…å«ï¼š\nâ€¢ ç‡Ÿæ”¶è¶¨å‹¢åœ–è¡¨\nâ€¢ ç”¢å“é¡åˆ¥åˆ†æ\nâ€¢ æ¯æ—¥æ˜ç´°è³‡æ–™\nâ€¢ KPI æŒ‡æ¨™ç¸½è¦½\n\næ ¼å¼ï¼šExcel (xlsx)');
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            generateRevenueTable();
            console.log('âœ… ç‡Ÿæ”¶å ±è¡¨ç³»çµ±å·²è¼‰å…¥');
        });
    </script>
</body>
</html>
