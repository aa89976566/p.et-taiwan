<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¶ ç•Œé‡‘æµè¨­å®š - åŒ å¯µå¾Œå°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .sidebar-item { transition: all 0.2s ease; }
        .sidebar-item:hover { background: rgba(230, 57, 70, 0.1); border-left: 4px solid #E63946; }
        .sidebar-item.active { background: rgba(230, 57, 70, 0.15); border-left: 4px solid #E63946; font-weight: 600; }
        .toggle-switch { position: relative; display: inline-block; width: 48px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; }
        .toggle-slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: #10b981; }
        input:checked + .toggle-slider:before { transform: translateX(24px); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- é ‚éƒ¨å°èˆªæ¬„ -->
    <nav class="bg-white border border-gray-200 fixed top-0 left-0 right-0 z-50">
        <div class="flex items-center justify-between px-6 py-4">
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-orange-400 rounded-xl flex items-center justify-center">
                        <i class="fas fa-paw text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">åŒ å¯µå¾Œå°</h1>
                        <p class="text-xs text-gray-500">é‡‘æµè¨­å®š</p>
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button class="relative text-gray-600 hover:text-gray-800">
                    <i class="fas fa-bell text-xl"></i>
                </button>
                <div class="flex items-center space-x-3 border-l pl-4">
                    <div class="hidden md:block text-right">
                        <p class="text-sm font-semibold text-gray-800">è¶…ç´šç®¡ç†å“¡</p>
                        <p class="text-xs text-gray-500">Super Admin</p>
                    </div>
                    <button onclick="showUserMenu()" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold">A</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- å´é‚Šæ¬„ -->
    <aside id="sidebar" class="sidebar fixed left-0 top-16 bottom-0 w-64 bg-white border border-gray-200 overflow-y-auto z-40">
    <div class="p-4">
        <nav class="space-y-2">
            <a href="admin-dashboard.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                <i class="fas fa-chart-line text-lg w-6"></i>
                <span>å„€è¡¨æ¿</span>
            </a>
            <div class="sidebar-section">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">ç”¨æˆ¶ç®¡ç†</p>
                <a href="admin-users.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-users text-lg w-6"></i>
                    <span>ç”¨æˆ¶åˆ—è¡¨</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">å•†å“ç®¡ç†</p>
                <a href="admin-products.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-box text-lg w-6"></i>
                    <span>ç”¢å“åˆ—è¡¨</span>
                </a>
                <a href="admin-orders.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-shopping-cart text-lg w-6"></i>
                    <span>è¨‚å–®ç®¡ç†</span>
                    <span class="ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full">15</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">ç‰©æµç®¡ç†</p>
                <a href="admin-shipping.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-shipping-fast text-lg w-6"></i>
                    <span>ç‰©æµè¨­å®š</span>
                </a>
                <a href="checkout.html" target="_blank" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-truck text-lg w-6"></i>
                    <span>æ¸¬è©¦çµå¸³æµç¨‹</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">æ¸¬é©—ç³»çµ±</p>
                <a href="admin-quizzes.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-clipboard-list text-lg w-6"></i>
                    <span>æ¸¬é©—åˆ—è¡¨</span>
                </a>
                <a href="admin-quiz-stats.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-chart-pie text-lg w-6"></i>
                    <span>æ¸¬é©—çµ±è¨ˆ</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">è¨‚é–±æœå‹™</p>
                <a href="admin-subscription-management.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-sync-alt text-lg w-6"></i>
                    <span>è¨‚é–±ç®¡ç†</span>
                </a>
                <a href="admin-subscription-options.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-list-alt text-lg w-6"></i>
                    <span>è¨‚é–±é¸é …</span>
                </a>
                <a href="admin-jar-program.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-recycle text-lg w-6"></i>
                    <span>æ›ç½è¨ˆç•«</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">æ•¸æ“šåˆ†æ</p>
                <a href="admin-analytics.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-chart-bar text-lg w-6"></i>
                    <span>ç‡Ÿæ”¶å ±è¡¨</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">ç³»çµ±è¨­å®š</p>
                
                <a href="admin-website-settings.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-palette text-lg w-6"></i>
                    <span>ç¶²ç«™ä½ˆå±€</span>
                </a>
                <a href="admin-payment.html" class="sidebar-item active flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-credit-card text-lg w-6"></i>
                    <span>é‡‘æµè¨­å®š</span>
                </a>
                <a href="admin-settings.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-cog text-lg w-6"></i>
                    <span>ç³»çµ±è¨­å®š</span>
                </a>
                <a href="admin-login.html" onclick="logout()" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-red-600">
                    <i class="fas fa-sign-out-alt text-lg w-6"></i>
                    <span>ç™»å‡º</span>
                </a>
            </div>
        </nav>
    </div>
</aside>

    <!-- ä¸»å…§å®¹å€ -->
    <main class="ml-64 pt-16 p-8">
        <!-- æ¨™é¡Œ -->
        <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-800 flex items-center">
                <i class="fas fa-credit-card text-green-500 mr-3"></i>ç¶ ç•Œ ECPay é‡‘æµè¨­å®š
            </h2>
            <p class="text-gray-600 mt-2">è¨­å®šç¶ ç•Œé‡‘æµä¸²æ¥ï¼Œåƒ…æ”¯æ´ä¿¡ç”¨å¡ä»˜æ¬¾</p>
        </div>

        <!-- API é‡‘é‘°è¨­å®š -->
        <div class="bg-white rounded-xl border border-gray-200 p-6 mb-6">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-key text-yellow-500 mr-2"></i>API é‡‘é‘°è¨­å®š
            </h3>
            
            <div class="space-y-4">
                <!-- ç’°å¢ƒé¸æ“‡ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ç’°å¢ƒæ¨¡å¼</label>
                    <select id="environment" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        <option value="test">æ¸¬è©¦ç’°å¢ƒ (Sandbox)</option>
                        <option value="production">æ­£å¼ç’°å¢ƒ (Production)</option>
                    </select>
                    <p class="text-xs text-gray-500 mt-1">æ¸¬è©¦ç’°å¢ƒç”¨æ–¼é–‹ç™¼æ¸¬è©¦ï¼Œæ­£å¼ç’°å¢ƒç”¨æ–¼å¯¦éš›äº¤æ˜“</p>
                </div>

                <!-- Merchant ID -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        ç‰¹åº—ç·¨è™Ÿ (MerchantID)
                        <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="merchantId" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" 
                           placeholder="ä¾‹å¦‚: 2000132">
                    <p class="text-xs text-gray-500 mt-1">è«‹è‡³ç¶ ç•Œå•†å®¶å¾Œå°å–å¾—</p>
                </div>

                <!-- Hash Key -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Hash Key
                        <span class="text-red-500">*</span>
                    </label>
                    <input type="password" id="hashKey" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" 
                           placeholder="è«‹è¼¸å…¥ Hash Key">
                </div>

                <!-- Hash IV -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Hash IV
                        <span class="text-red-500">*</span>
                    </label>
                    <input type="password" id="hashIV" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" 
                           placeholder="è«‹è¼¸å…¥ Hash IV">
                </div>

                <!-- æ¸¬è©¦å¸³è™Ÿèªªæ˜ -->
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                    <h4 class="font-semibold text-blue-800 mb-2">
                        <i class="fas fa-info-circle mr-2"></i>æ¸¬è©¦ç’°å¢ƒé‡‘é‘°
                    </h4>
                    <div class="text-sm text-blue-700 space-y-1">
                        <p><strong>Merchant ID:</strong> 2000132</p>
                        <p><strong>Hash Key:</strong> 5294y06JbISpM5x9</p>
                        <p><strong>Hash IV:</strong> v77hoKGq4kWxNNIS</p>
                        <p class="mt-2 text-xs">ä»¥ä¸Šç‚ºç¶ ç•Œæä¾›çš„æ¸¬è©¦ç’°å¢ƒé‡‘é‘°ï¼Œå¯ç›´æ¥ä½¿ç”¨</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ”¯ä»˜æ–¹å¼è¨­å®š -->
        <div class="bg-white rounded-xl border border-gray-200 p-6 mb-6">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-money-check-alt text-blue-500 mr-2"></i>æ”¯ä»˜æ–¹å¼è¨­å®š
            </h3>

            <div class="space-y-4">
                <!-- ä¿¡ç”¨å¡ -->
                <div class="flex items-center justify-between p-4 border-2 border-blue-200 rounded-lg bg-blue-50">
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-credit-card text-2xl text-blue-600"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">ä¿¡ç”¨å¡ä»˜æ¬¾</h4>
                            <p class="text-sm text-gray-600">æ”¯æ´ VISAã€MasterCardã€JCB ç­‰åœ‹éš›ä¿¡ç”¨å¡</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="px-3 py-1 bg-green-500 text-white text-sm rounded-full font-semibold">å·²å•Ÿç”¨</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="enableCredit" checked disabled>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <p class="text-sm text-gray-600">
                        <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                        ç›®å‰åƒ…æ”¯æ´ä¿¡ç”¨å¡ä»˜æ¬¾æ–¹å¼
                    </p>
                </div>
            </div>
        </div>

        <!-- å›å‚³ç¶²å€è¨­å®š -->
        <div class="bg-white rounded-xl border border-gray-200 p-6 mb-6">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-link text-purple-500 mr-2"></i>å›å‚³ç¶²å€è¨­å®š
            </h3>

            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ä»˜æ¬¾å®Œæˆå¾Œå°å‘ç¶²å€ (ReturnURL)</label>
                    <input type="text" id="returnUrl" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" 
                           placeholder="https://yoursite.com/payment/return"
                           value="https://yoursite.com/order-success.html">
                    <p class="text-xs text-gray-500 mt-1">å®¢æˆ¶ä»˜æ¬¾å®Œæˆå¾Œå°‡å°å‘æ­¤é é¢</p>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ä»˜æ¬¾çµæœé€šçŸ¥ç¶²å€ (OrderResultURL)</label>
                    <input type="text" id="notifyUrl" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" 
                           placeholder="https://yoursite.com/api/payment/notify">
                    <p class="text-xs text-gray-500 mt-1">ç¶ ç•Œå°‡ä»˜æ¬¾çµæœé€šçŸ¥åˆ°æ­¤ API ç¶²å€ï¼ˆå¾Œç«¯è™•ç†ï¼‰</p>
                </div>
            </div>
        </div>

        <!-- æ“ä½œæŒ‰éˆ• -->
        <div class="flex items-center space-x-4">
            <button onclick="saveSettings()" class="px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:shadow-xl transition">
                <i class="fas fa-save mr-2"></i>å„²å­˜è¨­å®š
            </button>
            <button onclick="testConnection()" class="px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition">
                <i class="fas fa-vial mr-2"></i>æ¸¬è©¦é€£ç·š
            </button>
            <a href="checkout.html" target="_blank" class="px-6 py-3 bg-purple-500 text-white font-semibold rounded-lg hover:bg-purple-600 transition">
                <i class="fas fa-shopping-cart mr-2"></i>æ¸¬è©¦çµå¸³
            </a>
        </div>

        <!-- èªªæ˜æ–‡ä»¶ -->
        <div class="mt-8 bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded-lg">
            <h3 class="font-semibold text-yellow-800 mb-3">
                <i class="fas fa-book mr-2"></i>ç¶ ç•Œé‡‘æµä¸²æ¥èªªæ˜
            </h3>
            <div class="text-sm text-yellow-700 space-y-2">
                <p><strong>1. ç”³è«‹ç¶ ç•Œå•†å®¶å¸³è™Ÿ:</strong> å‰å¾€ <a href="https://www.ecpay.com.tw/" target="_blank" class="underline">ç¶ ç•Œå®˜ç¶²</a> ç”³è«‹å•†å®¶å¸³è™Ÿ</p>
                <p><strong>2. å–å¾— API é‡‘é‘°:</strong> ç™»å…¥å•†å®¶å¾Œå°ï¼Œè‡³ã€Œç³»çµ±é–‹ç™¼ç®¡ç†ã€â†’ã€Œç³»çµ±ä»‹æ¥è¨­å®šã€å–å¾— MerchantIDã€HashKeyã€HashIV</p>
                <p><strong>3. è¨­å®šå›å‚³ç¶²å€:</strong> åœ¨ç¶ ç•Œå¾Œå°è¨­å®šä»˜æ¬¾å®Œæˆå°å‘ç¶²å€</p>
                <p><strong>4. æ¸¬è©¦ç’°å¢ƒ:</strong> å…ˆä½¿ç”¨æ¸¬è©¦ç’°å¢ƒé€²è¡Œä¸²æ¥æ¸¬è©¦ï¼Œç¢ºèªç„¡èª¤å¾Œå†åˆ‡æ›è‡³æ­£å¼ç’°å¢ƒ</p>
                <p><strong>5. ä¿¡ç”¨å¡æ¸¬è©¦å¡è™Ÿ:</strong> 4311-9522-2222-2222ï¼ˆä»»æ„æœ‰æ•ˆæ—¥æœŸèˆ‡ CVVï¼‰</p>
                <p class="mt-3"><a href="https://developers.ecpay.com.tw/" target="_blank" class="text-blue-600 hover:text-blue-800 underline">
                    <i class="fas fa-external-link-alt mr-1"></i>æŸ¥çœ‹å®Œæ•´é–‹ç™¼æ–‡ä»¶
                </a></p>
            </div>
        </div>
    </main>

    <script>
        // å„²å­˜è¨­å®š
        function saveSettings() {
            const settings = {
                environment: document.getElementById('environment').value,
                merchantId: document.getElementById('merchantId').value,
                hashKey: document.getElementById('hashKey').value,
                hashIV: document.getElementById('hashIV').value,
                returnUrl: document.getElementById('returnUrl').value,
                notifyUrl: document.getElementById('notifyUrl').value,
                paymentMethods: {
                    credit: true, // åƒ…æ”¯æ´ä¿¡ç”¨å¡
                    atm: false,
                    cvs: false,
                    barcode: false
                },
                updatedAt: new Date().toISOString()
            };

            // é©—è­‰å¿…å¡«æ¬„ä½
            if (!settings.merchantId || !settings.hashKey || !settings.hashIV) {
                alert('âš ï¸ è«‹å¡«å¯«å®Œæ•´çš„ API é‡‘é‘°è³‡è¨Š');
                return;
            }

            // å„²å­˜åˆ° localStorage
            localStorage.setItem('ecpaySettings', JSON.stringify(settings));
            
            alert('âœ… ç¶ ç•Œé‡‘æµè¨­å®šå·²å„²å­˜ï¼\n\nè«‹ç¢ºä¿ï¼š\n1. å·²åœ¨ç¶ ç•Œå¾Œå°è¨­å®šå›å‚³ç¶²å€\n2. æ¸¬è©¦å®Œæˆå¾Œå†åˆ‡æ›è‡³æ­£å¼ç’°å¢ƒ\n3. å®šæœŸæ›´æ–° API é‡‘é‘°ç¢ºä¿å®‰å…¨');
        }

        // æ¸¬è©¦é€£ç·š
        function testConnection() {
            const settings = localStorage.getItem('ecpaySettings');
            if (!settings) {
                alert('âš ï¸ è«‹å…ˆå„²å­˜è¨­å®š');
                return;
            }

            const config = JSON.parse(settings);
            
            alert(`ğŸ§ª æ¸¬è©¦é€£ç·šè³‡è¨Š\n\nç’°å¢ƒ: ${config.environment === 'test' ? 'æ¸¬è©¦ç’°å¢ƒ' : 'æ­£å¼ç’°å¢ƒ'}\nç‰¹åº—ç·¨è™Ÿ: ${config.merchantId}\n\næ”¯ä»˜æ–¹å¼:\nâœ“ ä¿¡ç”¨å¡ï¼ˆå”¯ä¸€æ”¯æ´ï¼‰\n\nå¯¦éš›ä¸²æ¥éœ€åœ¨å¾Œç«¯å¯¦ä½œ ECPay SDK`);
        }

        // é é¢è¼‰å…¥æ™‚è®€å–è¨­å®š
        window.addEventListener('DOMContentLoaded', function() {
            const saved = localStorage.getItem('ecpaySettings');
            if (saved) {
                const settings = JSON.parse(saved);
                document.getElementById('environment').value = settings.environment || 'test';
                document.getElementById('merchantId').value = settings.merchantId || '';
                document.getElementById('hashKey').value = settings.hashKey || '';
                document.getElementById('hashIV').value = settings.hashIV || '';
                document.getElementById('returnUrl').value = settings.returnUrl || '';
                document.getElementById('notifyUrl').value = settings.notifyUrl || '';
                
                // å¼·åˆ¶åªå•Ÿç”¨ä¿¡ç”¨å¡
                document.getElementById('enableCredit').checked = true;
            }
        });
    </script>
</body>
</html>
