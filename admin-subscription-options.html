<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訂閱選項管理 - 匠寵後台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        .tab-button.active {
            background-color: #FF6B6B;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50">
    <nav class="bg-white border border-gray-200 fixed top-0 left-0 right-0 z-50">
        <div class="flex items-center justify-between px-6 py-4">
            <!-- Logo & 標題 -->
            <div class="flex items-center space-x-4">
                <button onclick="toggleSidebar()" class="text-gray-600 hover:text-gray-800 lg:hidden">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-orange-400 rounded-xl flex items-center justify-center">
                        <i class="fas fa-paw text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">匠寵後台</h1>
                        <p class="text-xs text-gray-500">管理系統</p>
                    </div>
                </div>
            </div>

            <!-- 右側功能 -->
            <div class="flex items-center space-x-4">
                <!-- 搜尋 -->
                <div class="hidden md:block relative">
                    <input 
                        type="text" 
                        placeholder="搜尋..." 
                        class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent w-64"
                    >
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>

                <!-- 通知 -->
                <button class="relative text-gray-600 hover:text-gray-800">
                    <i class="fas fa-bell text-xl"></i>
                    <span class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">
                        3
                    </span>
                </button>

                <!-- 用戶選單 -->
                <div class="flex items-center space-x-3 border-l pl-4">
                    <div class="hidden md:block text-right">
                        <p class="text-sm font-semibold text-gray-800" id="adminName">超級管理員</p>
                        <p class="text-xs text-gray-500" id="adminRole">Super Admin</p>
                    </div>
                    <button onclick="showUserMenu()" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold">A</button>
                </div>
            </div>
        </div>
    </nav>
    <aside id="sidebar" class="sidebar fixed left-0 top-16 bottom-0 w-64 bg-white border border-gray-200 overflow-y-auto z-40">
    <div class="p-4">
        <nav class="space-y-2">
            <a href="admin-dashboard.html" class="sidebar-item active flex items-center space-x-3 px-4 py-3 rounded-lg">
                <i class="fas fa-chart-line text-lg w-6"></i>
                <span>儀表板</span>
            </a>
            <div class="sidebar-section">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">用戶管理</p>
                <a href="admin-users.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-users text-lg w-6"></i>
                    <span>用戶列表</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">商品管理</p>
                <a href="admin-products.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-box text-lg w-6"></i>
                    <span>產品列表</span>
                </a>
                <a href="admin-orders.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-shopping-cart text-lg w-6"></i>
                    <span>訂單管理</span>
                    <span class="ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full">15</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">物流管理</p>
                <a href="admin-shipping.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-shipping-fast text-lg w-6"></i>
                    <span>物流設定</span>
                </a>
                <a href="checkout.html" target="_blank" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-truck text-lg w-6"></i>
                    <span>測試結帳流程</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">測驗系統</p>
                <a href="admin-quizzes.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-clipboard-list text-lg w-6"></i>
                    <span>測驗列表</span>
                </a>
                <a href="admin-quiz-stats.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-chart-pie text-lg w-6"></i>
                    <span>測驗統計</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">訂閱服務</p>
                <a href="admin-subscription-management.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-sync-alt text-lg w-6"></i>
                    <span>訂閱管理</span>
                </a>
                <a href="admin-subscription-options.html" class="sidebar-item active flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-list-alt text-lg w-6"></i>
                    <span>訂閱選項</span>
                </a>
                <a href="admin-jar-program.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-recycle text-lg w-6"></i>
                    <span>換罐計畫</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">數據分析</p>
                <a href="admin-analytics.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-chart-bar text-lg w-6"></i>
                    <span>營收報表</span>
                </a>
            </div>
            <div class="sidebar-section mt-4">
                <p class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase">系統設定</p>
                <a href="admin-homepage.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-edit text-lg w-6"></i>
                    <span>首頁內容管理</span>
                </a>
                <a href="admin-website-settings.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-palette text-lg w-6"></i>
                    <span>網站佈局</span>
                </a>
                <a href="admin-payment.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-credit-card text-lg w-6"></i>
                    <span>金流設定</span>
                </a>
                <a href="admin-settings.html" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg">
                    <i class="fas fa-cog text-lg w-6"></i>
                    <span>系統設定</span>
                </a>
                <a href="admin-login.html" onclick="logout()" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-red-600">
                    <i class="fas fa-sign-out-alt text-lg w-6"></i>
                    <span>登出</span>
                </a>
            </div>
        </nav>
    </div>
</aside>
    
    <!-- 後台導航 -->
    <nav class="bg-white border border-gray-200 fixed top-0 left-0 right-0 z-50">
        <div class="flex items-center justify-between px-6 py-4">
            <!-- Logo & 標題 -->
            <div class="flex items-center space-x-4">
                <button onclick="toggleSidebar()" class="text-gray-600 hover:text-gray-800 lg:hidden">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-orange-400 rounded-xl flex items-center justify-center">
                        <i class="fas fa-paw text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">匠寵後台</h1>
                        <p class="text-xs text-gray-500">訂閱選項管理</p>
                    </div>
                </div>
            </div>

            <!-- 右側功能 -->
            <div class="flex items-center space-x-4">
                <!-- 搜尋 -->
                <div class="hidden md:block relative">
                    <input 
                        type="text" 
                        placeholder="搜尋..." 
                        class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent w-64"
                    >
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>

                <!-- 通知 -->
                <button class="relative text-gray-600 hover:text-gray-800">
                    <i class="fas fa-bell text-xl"></i>
                    <span class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center">
                        3
                    </span>
                </button>

                <!-- 用戶選單 -->
                <div class="flex items-center space-x-3 border-l pl-4">
                    <div class="hidden md:block text-right">
                        <p class="text-sm font-semibold text-gray-800" id="adminName">超級管理員</p>
                        <p class="text-xs text-gray-500" id="adminRole">Super Admin</p>
                    </div>
                    <button onclick="showUserMenu()" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold">A</button>
                </div>
            </div>
        </div>
    </nav>

    <div class="ml-64 mt-16 p-6">
        
        <div class="mb-8">
            <h2 class="text-3xl font-black mb-2">訂閱選項管理</h2>
            <p class="text-gray-600">管理訂閱表單中的蛋白質、蔬果凍乾、凍乾粉選項</p>
        </div>

        <!-- 分頁標籤 -->
        <div class="flex gap-2 mb-6">
            <button class="tab-button px-6 py-3 font-bold rounded active" onclick="switchTab('protein')">
                蛋白質選項
            </button>
            <button class="tab-button px-6 py-3 font-bold rounded bg-gray-200" onclick="switchTab('veggie')">
                蔬果凍乾選項
            </button>
            <button class="tab-button px-6 py-3 font-bold rounded bg-gray-200" onclick="switchTab('powder')">
                凍乾粉選項
            </button>
        </div>

        <!-- 蛋白質選項管理 -->
        <div id="protein-tab" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-xl font-bold mb-4">新增蛋白質選項</h3>
                <form id="protein-form" class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">選項ID (英文)</label>
                        <input type="text" name="id" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="beef" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">選項名稱</label>
                        <input type="text" name="name" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="牛肉系列" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">重量</label>
                        <input type="text" name="weight" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="30g 或 50g/80g">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">描述</label>
                        <input type="text" name="description" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="牛肉地瓜乾">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">功效</label>
                        <input type="text" name="benefit" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="補充能量·增強體力" required>
                    </div>
                    <div class="col-span-2">
                        <button type="submit" class="bg-green-500 text-white px-6 py-2 rounded font-bold hover:bg-green-600">
                            + 新增選項
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-xl font-bold mb-4">現有蛋白質選項</h3>
                <div id="protein-list" class="space-y-4">
                    <!-- 動態載入 -->
                </div>
            </div>
        </div>

        <!-- 蔬果凍乾選項管理 -->
        <div id="veggie-tab" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-xl font-bold mb-4">新增蔬果凍乾選項</h3>
                <form id="veggie-form" class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">選項ID (英文)</label>
                        <input type="text" name="id" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="zucchini" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">選項名稱</label>
                        <input type="text" name="name" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="櫛瓜凍乾" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">重量</label>
                        <input type="text" name="weight" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="15g">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-sm font-medium mb-2">功效</label>
                        <input type="text" name="benefit" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="改善食糞·減重" required>
                    </div>
                    <div class="col-span-2">
                        <button type="submit" class="bg-green-500 text-white px-6 py-2 rounded font-bold hover:bg-green-600">
                            + 新增選項
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-xl font-bold mb-4">現有蔬果凍乾選項</h3>
                <div id="veggie-list" class="space-y-4">
                    <!-- 動態載入 -->
                </div>
            </div>
        </div>

        <!-- 凍乾粉選項管理 -->
        <div id="powder-tab" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-xl font-bold mb-4">新增凍乾粉選項</h3>
                <form id="powder-form" class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">選項ID (英文)</label>
                        <input type="text" name="id" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="beef-tendon" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">選項名稱</label>
                        <input type="text" name="name" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="牛腱肉凍乾粉" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">重量</label>
                        <input type="text" name="weight" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="30g/50g">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-sm font-medium mb-2">功效</label>
                        <input type="text" name="benefit" class="w-full border-2 border-gray-200 rounded px-4 py-2" placeholder="增肌·術後恢復" required>
                    </div>
                    <div class="col-span-2">
                        <button type="submit" class="bg-green-500 text-white px-6 py-2 rounded font-bold hover:bg-green-600">
                            + 新增選項
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-xl font-bold mb-4">現有凍乾粉選項</h3>
                <div id="powder-list" class="space-y-4">
                    <!-- 動態載入 -->
                </div>
            </div>
        </div>

    </div>

    <script>
        // 本地存儲數據（實際應該連接後台API）
        let optionsData = {
            protein: JSON.parse(localStorage.getItem('protein-options') || '[]'),
            veggie: JSON.parse(localStorage.getItem('veggie-options') || '[]'),
            powder: JSON.parse(localStorage.getItem('powder-options') || '[]')
        };

        // 初始化預設數據（根據實際12種產品分類，重量根據套組在前台動態顯示）
        if (optionsData.protein.length === 0) {
            optionsData.protein = [
                { id: 'duck-throat', name: '鴨喉', description: '關節保健磨牙潔齒', benefit: '關節保健·磨牙潔齒' },
                { id: 'duck-lung', name: '鴨肺', description: '低脂高蛋白易消化', benefit: '低脂高蛋白·易消化' },
                { id: 'chicken-jerky', name: '雞肉乾', description: '增肌訓練獎勵', benefit: '增肌·訓練獎勵' },
                { id: 'duck-apple', name: '鴨肉蘋果肉乾', description: '溫和蛋白助消化', benefit: '溫和蛋白·助消化' },
                { id: 'beef-sweet-potato', name: '牛肉地瓜乾', description: '補充能量增強體力', benefit: '補充能量·增強體力' },
                { id: 'small-fish', name: '小魚乾', description: '補鈣骨骼保健', benefit: '補鈣·骨骼保健' }
            ];
        }

        if (optionsData.veggie.length === 0) {
            optionsData.veggie = [
                { id: 'zucchini', name: '櫛瓜凍乾', benefit: '改善食糞·減重' },
                { id: 'pumpkin', name: '南瓜凍乾', benefit: '腸道調理·改善便秘' }
            ];
        }

        if (optionsData.powder.length === 0) {
            optionsData.powder = [
                { id: 'beef-tendon', name: '牛腱肉凍乾粉', benefit: '增肌·術後恢復' },
                { id: 'chicken-liver-powder', name: '雞肉雞肝凍乾粉', benefit: '明目補血·開胃' },
                { id: 'chicken-red-yeast', name: '雞肉紅麴凍乾粉', benefit: '心血管保健·抗氧化' }
            ];
        }

        // 切換標籤頁
        function switchTab(tabName) {
            // 隱藏所有內容
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(el => {
                el.classList.remove('active');
                el.classList.add('bg-gray-200');
            });

            // 顯示目標內容
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            // 找到對應的按鈕並設置為 active
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach((btn, index) => {
                const tabNames = ['protein', 'veggie', 'powder'];
                if (tabNames[index] === tabName) {
                    btn.classList.add('active');
                    btn.classList.remove('bg-gray-200');
                }
            });

            // 重新渲染列表
            renderList(tabName);
        }

        // 渲染選項列表
        function renderList(type) {
            const container = document.getElementById(`${type}-list`);
            const options = optionsData[type];

            if (options.length === 0) {
                container.innerHTML = '<p class="text-gray-500">目前沒有任何選項</p>';
                return;
            }

            container.innerHTML = options.map((option, index) => `
                <div class="border-2 border-gray-200 rounded p-4 flex justify-between items-center">
                    <div>
                        <div class="font-bold text-lg">${option.name}</div>
                        ${option.weight ? `<div class="text-sm font-bold" style="color: #FF6B6B;">${option.weight}</div>` : ''}
                        ${option.description ? `<div class="text-sm text-gray-600">${option.description}</div>` : ''}
                        <div class="text-sm text-gray-500 mt-1">${option.benefit}</div>
                        <div class="text-xs text-gray-400 mt-1">ID: ${option.id}</div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editOption('${type}', ${index})" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                            編輯
                        </button>
                        <button onclick="deleteOption('${type}', ${index})" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                            刪除
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // 新增選項
        function addOption(type, formData) {
            const option = {
                id: formData.get('id'),
                name: formData.get('name'),
                weight: formData.get('weight') || '',
                description: formData.get('description') || '',
                benefit: formData.get('benefit')
            };

            // 檢查ID是否重複
            if (optionsData[type].some(opt => opt.id === option.id)) {
                alert('選項ID已存在！請使用不同的ID。');
                return;
            }

            optionsData[type].push(option);
            saveToStorage(type);
            renderList(type);
            document.getElementById(`${type}-form`).reset();
            alert('選項已新增！');
        }

        // 刪除選項
        function deleteOption(type, index) {
            if (confirm('確定要刪除這個選項嗎？')) {
                optionsData[type].splice(index, 1);
                saveToStorage(type);
                renderList(type);
                alert('選項已刪除！');
            }
        }

        // 編輯選項
        function editOption(type, index) {
            const option = optionsData[type][index];
            const newName = prompt('輸入新的選項名稱：', option.name);
            if (newName) {
                option.name = newName;
                const newBenefit = prompt('輸入新的功效：', option.benefit);
                if (newBenefit) {
                    option.benefit = newBenefit;
                    if (option.description !== undefined) {
                        const newDesc = prompt('輸入新的描述：', option.description);
                        if (newDesc !== null) option.description = newDesc;
                    }
                    saveToStorage(type);
                    renderList(type);
                    alert('選項已更新！');
                }
            }
        }

        // 保存到本地存儲
        function saveToStorage(type) {
            localStorage.setItem(`${type}-options`, JSON.stringify(optionsData[type]));
        }

        // 表單提交處理
        document.getElementById('protein-form').addEventListener('submit', (e) => {
            e.preventDefault();
            addOption('protein', new FormData(e.target));
        });

        document.getElementById('veggie-form').addEventListener('submit', (e) => {
            e.preventDefault();
            addOption('veggie', new FormData(e.target));
        });

        document.getElementById('powder-form').addEventListener('submit', (e) => {
            e.preventDefault();
            addOption('powder', new FormData(e.target));
        });

        // 初始化
        window.addEventListener('DOMContentLoaded', () => {
            renderList('protein');
            
            // 保存初始數據
            ['protein', 'veggie', 'powder'].forEach(type => saveToStorage(type));
        });
    </script>
</body>
</html>
